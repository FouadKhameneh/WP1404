# شرط‌های اعتبارسنجی ثبت‌نام (بک‌اند)

درخواست ثبت‌نام وقتی **نامعتبر** است که یکی از موارد زیر برقرار باشد.

---

## فیلدهای الزامی (خالی نباشند)

| فیلد | نوع | شرط |
|------|-----|-----|
| **username** | رشته | اجباری؛ نباید خالی باشد. |
| **email** | ایمیل | اجباری؛ باید فرمت ایمیل معتبر باشد و در سیستم یکتا باشد. |
| **phone** | رشته | اجباری؛ باید یکتا باشد (حداکثر ۲۰ کاراکتر). |
| **national_id** | رشته | اجباری؛ باید یکتا باشد (حداکثر ۳۲ کاراکتر). |
| **full_name** | رشته | اجباری (حداکثر ۲۵۵ کاراکتر). |
| **password** | رشته | اجباری؛ **حداقل ۸ کاراکتر**. |
| **password_confirm** | رشته | اجباری؛ باید **دقیقاً برابر با password** باشد. |

اگر حتی یکی از این فیلدها فرستاده نشود یا خالی/نامعتبر باشد، پاسخ با کد **۴۰۰** و پیام `Request validation failed.` و در بدنهٔ پاسخ داخل **details** لیست خطاهای هر فیلد برمی‌گردد.

---

## مواردی که ریکوئست نامعتبر می‌شود

1. **فیلد الزامی خالی یا فرستاده نشده:** مثلاً ارسال نکردن `phone` یا `national_id` یا خالی بودن `email`.
2. **فرمت ایمیل اشتباه:** مقدار `email` شبیه ایمیل نباشد.
3. **رمز عبور کوتاه‌تر از ۸ کاراکتر:** `password` کمتر از ۸ کاراکتر.
4. **عدم تطابق رمز و تکرار:** `password` و `password_confirm` یکی نباشند.
5. **تکراری بودن مقدار یکتا:**  
   - `username` تکراری  
   - `email` تکراری  
   - `phone` تکراری  
   - `national_id` تکراری  

در همهٔ این موارد بک‌اند همان پاسخ validation با **details** را برمی‌گرداند و فرانت‌اند باید این **details** را نشان دهد (مثلاً `username: A user with that username already exists.`).

---

## نمونه درخواست معتبر (بدنه JSON)

```json
{
  "username": "john_doe",
  "email": "john@example.com",
  "phone": "09121234567",
  "national_id": "1234567890",
  "full_name": "John Doe",
  "password": "SecurePass123",
  "password_confirm": "SecurePass123"
}
```

---

## مسیر API

- **POST** `/api/v1/identity/auth/register/`
- **Content-Type:** `application/json`
